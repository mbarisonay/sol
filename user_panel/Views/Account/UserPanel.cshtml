@using user_panel.Data
@model ApplicationUser
@{
    ViewData["Title"] = "User Panel";
}

<div class="container container-main-large">
    <div class="card-custom">
        <h2>Welcome, @Model.FirstName</h2>
        <div class="card my-4">
            <div class="card-header">
                Cabin Access
            </div>
            <div class="card-body">
                <p>Click the button below to scan the QR code at your reserved cabin's entrance to unlock the door.</p>
                <button id="scan-qr-button" class="btn btn-primary">Scan to Unlock Cabin</button>

                <!-- This section will be hidden by default and will hold the camera view -->
                <div id="qr-reader-container" class="mt-3" style="display: none;">
                    <div id="qr-reader" style="width: 100%; max-width: 500px;"></div>
                </div>
            </div>
        </div>

        @if (TempData["StatusMessage"] != null)
        {
            <div class="alert alert-success mt-3" role="alert">
                @TempData["StatusMessage"]
            </div>
        }

        <div class="credit-balance-box mt-4">
            <div class="balance-label">Credit Balance</div>
            <div class="balance-amount">@Model.CreditBalance.ToString("C")</div>
            <a class="btn btn-sm btn-success" asp-action="AddCredit">Add Credit</a>
        </div>

        <div class="mt-4 user-details">
            <h5>Account Details</h5>
            <hr style="border-color: var(--border-color);" />
            <dl class="row">
                <dt class="col-sm-4">Full Name</dt>
                <dd class="col-sm-8">@Model.FirstName @Model.LastName</dd>

                <dt class="col-sm-4">E-mail Address</dt>
                <dd class="col-sm-8">@Model.Email</dd>

                <dt class="col-sm-4">Phone Number</dt>
                <dd class="col-sm-8">@Model.PhoneNumber</dd>
            </dl>
        </div>

        <div class="mt-4 d-flex justify-content-start gap-2">
            <a class="btn btn-warning" asp-action="ChangePassword">Change Password</a>
            <a class="btn btn-info" asp-action="UpdateInformation">Update Information</a>
            <form class="d-inline" asp-action="Logout" method="post">
                <button type="submit" class="btn btn-danger">Logout</button>
            </form>
        </div>
    </div>
</div>

<!-- ==> THIS IS THE NEW SECTION ADDED AT THE END OF THE FILE <== -->
@section Scripts {
    <script src="~/js/user-panel-qr-scanner.js" asp-append-version="true"></script>
}